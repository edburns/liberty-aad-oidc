<?xml version="1.0" encoding="UTF-8"?>
<server description="defaultServer">

    <!-- Enable features -->
    <featureManager>
		<feature>javaee-8.0</feature>
		<feature>openidConnectClient-1.0</feature>
		<feature>transportSecurity-1.0</feature>
		<feature>appSecurity-2.0</feature>
    </featureManager>

    <!-- Import default Java trust store for root certs -->
    <ssl id="defaultSSLConfig" keyStoreRef="defaultKeyStore" trustStoreRef="defaultTrustStore" />
    <keyStore id="defaultKeyStore" type="JKS" password="${default.keystore.pass}" />
    <keyStore id="defaultTrustStore" location="${JAVA_HOME}/lib/security/cacerts" type="JKS" password="${java.truststore.pass}" />
    
    <openidConnectClient id="liberty-aad-oidc-helloworld"
        clientId="${client.id}"
		clientSecret="${client.secret}"
        discoveryEndpointUrl="https://login.microsoftonline.com/${tenant.id}/v2.0/.well-known/openid-configuration"
        signatureAlgorithm="RS256"
        userIdentityToCreateSubject="upn"
        groupIdentifier="groups"
        inboundPropagation="supported" />
                         
    <!-- To access this server from a remote client add a host attribute to 
		the following element, e.g. host="*" -->
	<httpEndpoint id="defaultHttpEndpoint" host="*" httpPort="9080" httpsPort="9543" />

    <!-- Automatically expand WAR files and EAR files -->
	<applicationManager autoExpand="true" />

    <webApplication id="hello-world" location="${server.config.dir}/apps/hello-world.war">
        <application-bnd>
            <security-role name="users">
                <special-subject type="ALL_AUTHENTICATED_USERS"/>
            </security-role>
        </application-bnd>
    </webApplication>
</server>